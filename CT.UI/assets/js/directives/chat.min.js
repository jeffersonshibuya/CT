(function(){"use strict";function n(){return{restrict:"EA",template:'<div><ol class="discussion"><li class="messages-date" ng-repeat-start="message in newChatArray()" ng-if="displayDate($index) || $index == 0">{{message.date | amDateFormat:\'dddd, MMM D, h:mm a\'}}<\/li><li ng-class="{\'self\' : message.idUser == idSelf, \'other\' : message.idUser !== idSelf, \'nextSame\': newChatArray()[$index+1].idUser == message.idUser && !nextDate($index)}" ng-repeat-end><div class="message"><div class="message-name" ng-if="newChatArray()[$index-1].idUser !== message.idUser || displayDate($index)">{{  message.user }}<\/div><div class="message-text">{{ message.content }}<\/div><div class="message-avatar"><img ng-src="{{ message.avatar }}" alt=""><\/div><\/div><\/li><\/ol>',replace:!0,scope:{messages:"=",idSelf:"=",idOther:"="},link:function(n){n.newChatArray=function(){for(var t,r=[],i=0;i<n.messages.length;i++)t=n.messages[i],(t.idUser==n.idSelf||t.idOther==n.idSelf)&&(t.idUser==n.idOther||t.idOther==n.idOther)&&r.push(t);return r};n.displayDate=function(t){var r,u,f,e,i=n.newChatArray();if(t===0)if(i.length>1)r=new Date(i[t].date),u=new Date(i[t+1].date),f=u-r,e=Math.round(f%864e5%36e5/6e4);else return!0;else r=new Date(i[t-1].date),u=new Date(i[t].date),f=u-r,e=Math.round(f%864e5%36e5/6e4);return e>1?!0:!1};n.nextDate=function(t){var r,u,f,e,i=n.newChatArray();return t<i.length-1&&(r=new Date(i[t].date),u=new Date(i[t+1].date),f=u-r,e=Math.round(f%864e5%36e5/6e4)),e>1?!0:!1}}}}function t(){return{restrict:"EA",template:'<form ng-submit="submitChat()"><div class="message-bar"><div class="message-inner"><a href="#" class="link icon-only"><i class="fa fa-camera"><\/i><\/a><div class="message-area"><input placeholder="Message" ng-model="ngModel" /><\/div><a translate="offsidebar.chat.SEND" href="#" class="link ng-scope" ng-click="submitChat()">Send<\/a><\/div><\/div><\/form><\/div>',replace:!0,scope:{submitFunction:"=",ngModel:"="},link:function(n,t,i){n.submitChat=function(){if(n.submitFunction(),typeof i.scrollElement!="undefined"){var t=angular.element(i.scrollElement),r=t.find(".discussion > li:last");r.length&&t.scrollToElementAnimated(r)}}}}}app.directive("clipChat",n);app.directive("chatSubmit",t)})();